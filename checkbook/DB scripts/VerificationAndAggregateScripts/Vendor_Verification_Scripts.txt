select * from etl.stg_fms_vendor

update etl.stg_fms_vendor set vendor_history_id = null

select * from vendor where vendor_customer_code = '12345A'

select * from vendor_history a, vendor b where a.vendor_id = b.vendor_id and b.vendor_customer_code = '12345A'

delete from vendor where vendor_customer_code = '12345A'
delete from vendor_history where vendor_history_id > 140800
delete from vendor_business_type where vendor_history_id > 140800
delete from vendor_address where vendor_history_id > 140800



select * from etl.etl_data_load_file where load_id = 13 

update etl.etl_data_load_file set processed_flag = 'V' where load_file_id= 8


budget								agency_history_id
disbursement						agency_history_id
disbursement_line_item				agency_history_id
history_agreement					agency_history_id
history_agreement_accounting_line	agency_history_id
history_master_agreement			agency_history_id
payroll								agency_history_id
payroll_summary						agency_history_id
pending_contracts					submitting_agency_id
pending_contracts					awarding_agency_id
pending_contracts					funding_agency_id
pending_contracts					document_agency_id
revenue								document_agency_history_id
revenue								agency_history_id
revenue_budget						agency_history_id


select b.file_name, a.load_file_id, a.num_transactions from etl.etl_data_load_verification a, etl.etl_data_load_file b , etl.etl_data_load c , etl.ref_data_source d
WHERE a.load_file_id = b.load_file_id AND b.load_id = c.load_id AND c.data_source_code = d.data_source_code
AND a.data_source_code = 'V' and a.description = 'Number of records inserted into vendor_history'  AND table_order=1
order by d.data_source_order, b.file_timestamp,b.file_name


copy (
select * from etl.archive_payroll where employee_number like '%28266' and payroll_number = '015' and pay_date in ('2011-01-06','2011-01-07')
UNION
select * from etl.archive_payroll where employee_number like '%134830' and payroll_number = '015' and pay_date in ('2011-01-06','2011-01-07', '2011-01-20','2011-02-18','2011-02-04')
UNION
select * from etl.archive_payroll where employee_number like '%134880' and payroll_number = '015' and pay_date in ('2011-02-18','2011-02-04') order by employee_number, pay_date) TO '/home/gpadmin/TREDDY/payroll_data_from_source_for_highlighted.csv' CSV HEADER




-- 02/12/2013


select * from vendor where legal_name ilike '%PRO_METAL%'  -- 8343

select * from vendor_history where vendor_id = 8343

select * from vendor_business_type where vendor_history_id in (179398, 5798, 143699, 171630) order by vendor_history_id

select * from ref_business_type 

select * from ref_minority_type order by minority_type_id

select * from vendor where legal_name ilike '%EXCELLENT CONS%'  -- 11206
select * from vendor_history where vendor_id = 11206
select * from vendor_business_type where vendor_history_id in (16906, 119724) order by vendor_history_id

select * from fmsv_business_type where vendor_customer_code in ('0002499381','0002840820')

select * from etl.stg_fmsv_business_type where vend_cust_cd in ('0002499381','0002840820')

select * from etl.stg_fmsv_business_type where bus_typ = 'WMNO'

select count(*), bus_typ from etl.stg_fmsv_business_type where min_typ IS NULL AND bus_typ_sta = 2 group by 2

88;"LOCB"
3;"EENT"
1939;"WMNO"
138;"EXMP"


select count(*), bus_typ from etl.stg_fmsv_business_type where bus_typ_sta = 2 group by 2
